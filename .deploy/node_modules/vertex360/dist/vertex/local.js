"use strict";var express=require("express"),path=require("path"),favicon=require("serve-favicon"),logger=require("morgan"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),sessions=require("client-sessions"),db=require("./db");require("dotenv").config();var basePath=__dirname+"/../../../../",defaultConfiguration=function(e){var r=path.join(basePath,"public");e.use(express.static(r));var s=path.join(basePath,"views");e.set("views",s)},configureOptions=function(e,r){if(null!=r){if(null==e)return void defaultConfiguration(r);var s=e.db;null!=s&&(null==s.type?db.connect(s.url,s.onError):(s.type,db.connectMongo(s.url,s.onError)));var i=e.views||"views",o=path.join(basePath,i);r.set("views",o);var n=e.static||"public",t=path.join(basePath,n);r.use(express.static(t))}};module.exports={app:function(e){var r=express();return configureOptions(e,r),r.use(bodyParser.json()),r.use(bodyParser.urlencoded({extended:!1})),r.use(cookieParser()),r.use(logger("dev")),process.env.SESSION_SECRET&&r.use(sessions({cookieName:"vertexSession",secret:process.env.SESSION_SECRET,duration:864e5,activeDuration:18e5})),r.set("view engine","mustache"),r.engine("mustache",require("hogan-middleware").__express),r},router:function(){return new express.Router}};